echo host side stuff
./Desktop/internetToTarget.sh
sudo apt-get install libgpiod-dev

ssh-keygen -f "/home/trevor/.ssh/known_hosts" -R "192.168.7.2"
ssh-copy-id trevor@192.168.7.2

ssh-keygen -t ed25519 -C "trevor.ruttan05@gmail.com"
ssh-keygen -f "/home/trevor/.ssh/known_hosts" -R "192.168.7.1"
ssh-copy-id trevor@192.168.7.1
ssh trevor@192.168.7.2

echo target side stuff

sudo nano /etc/systemd/resolved.conf
echo â€¢ Add the following line under the [RESOLVE] section:
echo DNS=8.8.8.8


#part 2
sudo reboot
ssh trevor@192.168.7.2

sudo route add default gw 192.168.7.1
echo Install NFS client:
sudo apt update
sudo apt upgrade # Optional, but a reasonable idea
sudo apt install nfs-common
sudo mkdir /mnt/remote
sudo chown trevor /mnt/remote
sudo mount -t nfs 192.168.7.1:/home/trevor/ensc351/public /mnt/remote
		

echo enable spi
nano /boot/firmware/extlinux/extlinux.conf
echo add   fdtoverlays /overlays/k3-am67a-beagley-ai-spidev0.dtbo
echo while we are here enable pwm0
echo add   fdtoverlays /overlays/k3-am67a-beagley-ai-pwm-epwm0-gpio12.dtbo
k3-am67a-beagley-ai-pwm-ecap0-gpio12.dtbo
k3-am67a-beagley-ai-pwm-ecap1-gpio16.dtbo
k3-am67a-beagley-ai-pwm-ecap2-gpio18.dtbo
k3-am67a-beagley-ai-pwm-epwm0-gpio12.dtbo
k3-am67a-beagley-ai-pwm-epwm1-gpio13.dtbo


sudo shutdown -r now
sudo apt-get update
sudo apt-get install -y python3-spidev
sudo chmod ugo+rwx /dev/spidev*


echo enable gpio *not actually sure of how proper this works tbh
sudo apt-get install python3-rpi.gpio

sudo usermod -a -G spi trevor
sudo nano /etc/udev/rules.d/99-spi-access.rules
echo # Set group ownership and permissions for SPI devices
echo KERNEL=="spidev0.0", GROUP="spi", MODE="0660"
echo KERNEL=="spidev0.1", GROUP="spi", MODE="0660"

sudo udevadm control --reload-rules
sudo udevadm trigger

sudo reboot

sudo nano /etc/hostname
echo may need to edit this
sudo nano /etc/hosts
sudo reboot

sudo nano /etc/locale.gen
echo uncomment en_CA.UTF-8 UTF-8

echo add in ascii art here, ascii art kept in ascii.txt for clarity
sudo nano /etc/motd
echo copy past all of ascii.txt in

sudo nano ~/.profile
echo add to end of file:
#/home/trevor/a1
sudo /home/trevor/internetToTarget.sh
sudo /home/trevor/mountNFS.sh


ssh trevor@192.168.7.2


echo network config stuff for a1
ip a
ip r
cat /etc/resolv.conf
ping 192.168.7.1
hostname -I

echo misc a1 stuff
cat ../../proc/version
cat ../../proc/uptime
cat ../../boot/firmware/ID.txt




echo XBOX Kinect V2 setup
ON TARGET:
sudo apt update
sudo apt install build-essential cmake pkg-config
sudo apt install libusb-1.0-0-dev
sudo apt install libglfw3-dev libva-dev
sudo apt install libturbojpeg-dev

cd ~
git clone https://github.com/OpenKinect/libfreenect2.git
cd libfreenect2
mkdir build
cd build

cmake -DBUILD_EXAMPLES=ON -DCMAKE_INSTALL_PREFIX=$HOME/freenect2_install ..
make
make install

sudo nano /etc/udev/rules.d/90-kinect2.rules
echo paste this in: 
# BUS: 03, DEVICE: 02
SUBSYSTEM=="usb", ATTR{idVendor}=="045e", ATTR{idProduct}=="02c4", MODE="0666"
# BUS: 03, DEVICE: 03
SUBSYSTEM=="usb", ATTR{idVendor}=="045e", ATTR{idProduct}=="02d0", MODE="0666"
# BUS: 03, DEVICE: 04
SUBSYSTEM=="usb", ATTR{idVendor}=="045e", ATTR{idProduct}=="02d8", MODE="0666"
# BUS: 03, DEVICE: 05
SUBSYSTEM=="usb", ATTR{idVendor}=="045e", ATTR{idProduct}=="02da", MODE="0666"
# BUS: 03, DEVICE: 06
SUBSYSTEM=="usb", ATTR{idVendor}=="045e", ATTR{idProduct}=="02db", MODE="0666"

sudo udevadm control --reload-rules
sudo udevadm trigger

export LD_LIBRARY_PATH=$HOME/freenect2_install/lib:$LD_LIBRARY_PATH
$HOME/freenect2_install/bin/Protonect
./bin/Protonect

# Define the installation path
# Set the C compiler flag path to headers
# Set the Linker flag path to libraries
# Set the runtime library path (this was already done, but is good practice)
export FREENECT2_HOME=$HOME/freenect2_install
export CFLAGS="-I$FREENECT2_HOME/include"
export LDFLAGS="-L$FREENECT2_HOME/lib -Wl,-rpath,$FREENECT2_HOME/lib"
export LD_LIBRARY_PATH=$FREENECT2_HOME/lib:$LD_LIBRARY_PATH

cp /home/trevor/libfreenect2/include/libfreenect2/*.h ~/freenect2_install/include/libfreenect2/

g++ $CFLAGS depth_viewer.c -o depth_viewer $LDFLAGS -lfreenect2 -lusb-1.0

export LIBFREENECT2_PIPELINE=cpu
./depth_viewer

ON HOST:
scp trevor@192.168.7.2:~/depth_frame_*.csv ~/ENSC351/work/frames

sudo apt update
sudo apt install python3-pip
sudo apt install python3-numpy python3-matplotlib


cd ~/ENSC351/work/frames
python3 visualize_depth.py 'depth_frame_*.csv'

sudo touch /etc/rc.local
sudo chmod 744 /etc/rc.local
sudo nano /etc/rc.local
#!/bin/sh -e
#
# Increase USBFS memory for Kinect V2
echo 1000 > /sys/module/usbcore/parameters/usbfs_memory_mb

exit 0
sudo reboot
cat /sys/module/usbcore/parameters/usbfs_memory_mb


as2
aarch64-linux-gnu-gcc noworky.c -o noworky -Wall -g -std=c99 -D _POSIX_C_SOURCE=200809L -Werror
cp noworky ../../../public/myApps

netcat -u 192.168.7.2 12345


as3
sudo apt install usbutils alsa-utils i2c-tools
lsusb
cat /proc/asound/cards

sudo nano /etc/asound.conf

write in the file (value depends on what shows up on catting the conf:
defaults.pcm.card 0
defaults.ctl.card 0


also blacklist the hdmi internal sound card so that the usb always goes to slot 0 (ask ai this one i forgot to write it down)

speaker-test (plays white noise)
alsamixer

sudo apt update
sudo apt upgrade
sudo apt install espeak
espeak 'All your bits are belong to us.' -w test.wav
aplay test.wav

sudo apt update
sudo apt install libasound2
ls /usr/lib/aarch64-linux-gnu/libasound.so.2*

on HOST
sudo apt update
sudo dpkg --add-architecture arm64
sudo apt update
sudo apt install libasound2-dev:arm64
ls /usr/lib/aarch64-linux-gnu/libasound.so



